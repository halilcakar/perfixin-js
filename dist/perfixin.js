var perfixin=function(){"use strict";let e;const t=e=>e-performance.timing.navigationStart,n=()=>{const[e]=performance.getEntriesByName("first-contentful-paint");return e&&e.startTime||0},r=()=>{const e=performance.getEntries().find((e=>"navigation"===e.initiatorType));return e&&e.responseEnd-e.requestStart||0},i=e=>{let t=0,n=Number.MAX_VALUE,r=0;return e.forEach((e=>{r<e.responseEnd&&(r=e.responseEnd),n>e.startTime&&0!==e.startTime&&(n=e.startTime)})),(t=r-n)>0?t:0},o=e=>i(performance.getEntriesByType("resource").filter((t=>t.name.split("?")[0].endsWith("."+e)))),a=e=>({timeToFirstByte:performance.timing.responseStart-performance.timing.navigationStart,firstContentfulPaint:n(),domContentLoaded:performance.timing.domContentLoadedEventEnd-performance.timing.navigationStart,windowLoad:t(e),image:i(performance.getEntriesByType("resource").filter((e=>"img"===e.initiatorType))),document:r(),script:o("js"),css:o("css"),font:o("woff")+o("woff2")}),s=(t,n)=>{if(t.debug)return console.log("Perfixin debugging.."),console.log(n);let{url:r}=t;r||(r="/perfixin/create"),fetch(r,{method:"POST",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),clearTimeout(e)};return t=>{if(!window)throw new Error("Cannot get metrics without window =)");if(!performance&&!performance.timing)throw new Error("Browser is not compatible with Perfixin..");if(performance&&performance.timing)return e=setTimeout((()=>{s(t,a(performance.timing.loadEventEnd))}),3e3);window.onload=()=>{const n=(new Date).getTime();return e=setTimeout((()=>{s(t,a(n))}),3e3)}}}();
